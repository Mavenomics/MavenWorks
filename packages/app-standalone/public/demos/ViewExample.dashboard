{"layout":{"properties":{"caption":"Dashboard"},"typeName":0,"uuid":"1df1ff68-4c22-4ea6-8f8f-be97e71ac010","attachedProperties":[{"Fixed Size (px)":null,"Stretch":0.3215434083601286}],"children":[{"properties":{"prunable":true,"horizontal":true},"typeName":0,"uuid":"df73887d-37ed-4245-aa1a-b4caf8276333","attachedProperties":[{"Fixed Size (px)":null,"Stretch":0.3215434083601286},{"Fixed Size (px)":null,"Stretch":1}],"children":[{"properties":{"prunable":true,"horizontal":false},"typeName":0,"uuid":"40f067af-a4b8-48d1-b352-7807a6e05301","attachedProperties":[{"Fixed Size (px)":null,"Stretch":0.3215434083601286},{"Fixed Size (px)":null,"Stretch":1}],"children":[{"properties":{"caption":"ViewSelector"},"typeName":1,"uuid":"2a2a84bb-145c-4fd4-bcb0-7f30b1b95b83","guid":"f86978f9-68f6-42cd-b377-c40dfdaf9b13"},{"properties":{"showRegion":true,"caption":"SelectPart"},"typeName":1,"uuid":"3337c803-c7d1-440f-9701-523f77c5635c","guid":"d28ad77a-4c49-4ff8-9674-8799e3bed4a3"}]},{"properties":{"prunable":true,"horizontal":false},"typeName":0,"uuid":"2e840c8b-d091-4413-b5d8-9072aeb36a0b","attachedProperties":[{"Fixed Size (px)":null,"Stretch":1.563819165623427},{"Fixed Size (px)":null,"Stretch":1.1041831270787035}],"children":[{"properties":{"caption":"ViewEditor","showRegion":true},"typeName":1,"uuid":"ac819db6-ee3f-406a-90ee-6caae83fe686","guid":"1c5fd33b-cc83-4845-ad7c-bdfbf53555eb"},{"properties":{"showRegion":true,"caption":"SlickGrid"},"typeName":1,"uuid":"81f23a40-991b-4502-a141-b9e2694f45f6","guid":"3c04b6a7-021e-42ab-a0a9-0608d1b7cb6d"}]}]}]},"parts":{"1c5fd33b-cc83-4845-ad7c-bdfbf53555eb":{"application/vnd.maven.part+json":{"name":"ViewEditor","id":"1c5fd33b-cc83-4845-ad7c-bdfbf53555eb","options":{"AvailableColumns":{"typeName":"Object","value":[{"name":"x","expr":"x"},{"name":"x-5","expr":"x-5","format":{"ConditionalFormatting.Simple":"NegRedPosGreen","Number.FormatString":"0"}},{"name":"x%2","expr":"x%2","canGroup":true}]},"Config":{"type":"Global","expr":"config","globals":["config"]},"Query":{"type":"Global","expr":"query","globals":["query"]},"Formatting":{"type":"Global","expr":"formatting","globals":["formatting"]},"BaseQuery":{"typeName":"String","value":"SELECT\n  %%COLUMNS%%\nFROM\n  Lattice('x = 1 to 10 step 1')\n  %%GROUPS%%"}}},"text/plain":"VisualEditorPart"},"f86978f9-68f6-42cd-b377-c40dfdaf9b13":{"application/vnd.maven.part+json":{"name":"ViewSelector","id":"f86978f9-68f6-42cd-b377-c40dfdaf9b13","options":{"ViewNames":{"type":"Global","expr":"views","globals":["views"]},"Config":{"type":"Global","expr":"config","globals":["config"]},"SelectedView":{"type":"Global","expr":"selectedView","globals":["selectedView"]},"__storedViews":{"typeName":"Object","value":{"test":"{\"selected\":[\"x\"]}","test2":"{\"selected\":[\"x%2\",\"x-5\"],\"selectedGroups\":[\"x%2\"]}"}}}},"text/plain":"VisualEditorPart"},"3c04b6a7-021e-42ab-a0a9-0608d1b7cb6d":{"application/vnd.maven.part+json":{"name":"SlickGrid","id":"3c04b6a7-021e-42ab-a0a9-0608d1b7cb6d","options":{"Input Table":{"type":"JavaScript","expr":"return RunMql(globals.query);","globals":["query"]},"Formatting":{"type":"Global","expr":"formatting","globals":["formatting"]},"Show Path Column":{"typeName":"Boolean","value":true}}},"text/plain":"VisualEditorPart"},"d28ad77a-4c49-4ff8-9674-8799e3bed4a3":{"application/vnd.maven.part+json":{"name":"SelectPart","id":"d28ad77a-4c49-4ff8-9674-8799e3bed4a3","options":{"Value":{"type":"Global","expr":"selectedView","globals":["selectedView"]},"Options":{"type":"Global","expr":"views","globals":["views"]}}},"text/plain":"VisualEditorPart"}},"metadata":{},"globals":[{"name":"query","type":"String","value":"SELECT\n  x%2 as [x%2], x-5 as [x-5]\nFROM\n  Lattice('x = 1 to 10 step 1')\n  GROUP BY x%2 WITH ROLLUP"},{"name":"formatting","type":"String","value":"{\"x-5\":{\"ConditionalFormatting.Simple\":\"NegRedPosGreen\",\"Number.FormatString\":\"0\"}}"},{"name":"views","type":"Array","value":[{"typeName":"String","value":"test"},{"typeName":"String","value":"test2"}]},{"name":"selectedView","type":"String","value":"test2"},{"name":"config","type":"String","value":"{\"selected\":[\"x%2\",\"x-5\"],\"selectedGroups\":[\"x%2\"]}"}],"localParts":{"17608d72-9b36-4452-bf8b-4a4721cf5bd2":{"typeName":"Part","id":"17608d72-9b36-4452-bf8b-4a4721cf5bd2","name":"ViewEditor","path":"/ViewEditor","lastModified":"2019-08-29T21:20:03.220Z","data":{"htmlText":"<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\" integrity=\"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\" crossorigin=\"anonymous\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css\">\n<script src=\"https://code.jquery.com/jquery-3.2.1.slim.min.js\" integrity=\"sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js\" integrity=\"sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q\" crossorigin=\"anonymous\"></script>\n<script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js\" integrity=\"sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.15/lodash.min.js\"></script>\n<script>/*\n * @license\n *\n * Multiselect v2.5.5\n * http://crlcu.github.io/multiselect/\n *\n * Copyright (c) 2016-2018 Adrian Crisan\n * Licensed under the MIT license (https://github.com/crlcu/multiselect/blob/master/LICENSE)\n */\n\nif(\"undefined\"==typeof jQuery)throw new Error(\"multiselect requires jQuery\");!function(t){\"use strict\";var e=t.fn.jquery.split(\" \")[0].split(\".\");if(e[0]<2&&e[1]<7)throw new Error(\"multiselect requires jQuery version 1.7 or higher\")}(jQuery),function(t){\"function\"==typeof define&&define.amd?define([\"jquery\"],t):t(jQuery)}(function(t){\"use strict\";var e=function(t){function e(e,o){var n=e.prop(\"id\");if(this.$left=e,this.$right=t(t(o.right).length?o.right:\"#\"+n+\"_to\"),this.actions={$leftAll:t(t(o.leftAll).length?o.leftAll:\"#\"+n+\"_leftAll\"),$rightAll:t(t(o.rightAll).length?o.rightAll:\"#\"+n+\"_rightAll\"),$leftSelected:t(t(o.leftSelected).length?o.leftSelected:\"#\"+n+\"_leftSelected\"),$rightSelected:t(t(o.rightSelected).length?o.rightSelected:\"#\"+n+\"_rightSelected\"),$undo:t(t(o.undo).length?o.undo:\"#\"+n+\"_undo\"),$redo:t(t(o.redo).length?o.redo:\"#\"+n+\"_redo\"),$moveUp:t(t(o.moveUp).length?o.moveUp:\"#\"+n+\"_move_up\"),$moveDown:t(t(o.moveDown).length?o.moveDown:\"#\"+n+\"_move_down\")},delete o.leftAll,delete o.leftSelected,delete o.right,delete o.rightAll,delete o.rightSelected,delete o.undo,delete o.redo,delete o.moveUp,delete o.moveDown,this.options={keepRenderingSort:o.keepRenderingSort,submitAllLeft:void 0===o.submitAllLeft||o.submitAllLeft,submitAllRight:void 0===o.submitAllRight||o.submitAllRight,search:o.search,ignoreDisabled:void 0!==o.ignoreDisabled&&o.ignoreDisabled,matchOptgroupBy:void 0!==o.matchOptgroupBy?o.matchOptgroupBy:\"label\"},delete o.keepRenderingSort,o.submitAllLeft,o.submitAllRight,o.search,o.ignoreDisabled,o.matchOptgroupBy,this.callbacks=o,\"function\"==typeof this.callbacks.sort){var i=this.callbacks.sort;this.callbacks.sort={left:i,right:i}}this.init()}return e.prototype={init:function(){var e=this;e.undoStack=[],e.redoStack=[],e.options.keepRenderingSort&&(e.skipInitSort=!0,!1!==e.callbacks.sort&&(e.callbacks.sort={left:function(e,o){return t(e).data(\"position\")>t(o).data(\"position\")?1:-1},right:function(e,o){return t(e).data(\"position\")>t(o).data(\"position\")?1:-1}}),e.$left.attachIndex(),e.$right.each(function(e,o){t(o).attachIndex()})),\"function\"==typeof e.callbacks.startUp&&e.callbacks.startUp(e.$left,e.$right),e.skipInitSort||(\"function\"==typeof e.callbacks.sort.left&&e.$left.mSort(e.callbacks.sort.left),\"function\"==typeof e.callbacks.sort.right&&e.$right.each(function(o,n){t(n).mSort(e.callbacks.sort.right)})),e.options.search&&e.options.search.left&&(e.options.search.$left=t(e.options.search.left),e.$left.before(e.options.search.$left)),e.options.search&&e.options.search.right&&(e.options.search.$right=t(e.options.search.right),e.$right.before(t(e.options.search.$right))),e.events(),\"function\"==typeof e.callbacks.afterInit&&e.callbacks.afterInit()},events:function(){var e=this;e.options.search&&e.options.search.$left&&e.options.search.$left.on(\"keyup\",function(t){if(e.callbacks.fireSearch(this.value)){e.$left.find('option:search(\"'+this.value+'\")').mShow(),e.$left.find('option:not(:search(\"'+this.value+'\"))').mHide(),e.$left.find(\"option\").closest(\"optgroup\").mHide(),e.$left.find(\"option:not(.hidden)\").parent(\"optgroup\").mShow()}else e.$left.find(\"option, optgroup\").mShow()}),e.options.search&&e.options.search.$right&&e.options.search.$right.on(\"keyup\",function(t){if(e.callbacks.fireSearch(this.value)){e.$right.find('option:search(\"'+this.value+'\")').mShow(),e.$right.find('option:not(:search(\"'+this.value+'\"))').mHide(),e.$right.find(\"option\").closest(\"optgroup\").mHide(),e.$right.find(\"option:not(.hidden)\").parent(\"optgroup\").mShow()}else e.$right.find(\"option, optgroup\").mShow()}),e.$right.closest(\"form\").on(\"submit\",function(t){e.options.search&&(e.options.search.$left&&e.options.search.$left.val(\"\").trigger(\"keyup\"),e.options.search.$right&&e.options.search.$right.val(\"\").trigger(\"keyup\")),e.$left.find(\"option\").prop(\"selected\",e.options.submitAllLeft),e.$right.find(\"option\").prop(\"selected\",e.options.submitAllRight)}),e.$left.on(\"dblclick\",\"option\",function(t){t.preventDefault();var o=e.$left.find(\"option:selected:not(.hidden)\");o.length&&e.moveToRight(o,t)}),e.$left.on(\"click\",\"optgroup\",function(e){\"OPTGROUP\"==t(e.target).prop(\"tagName\")&&t(this).children().prop(\"selected\",!0)}),e.$left.on(\"keypress\",function(t){if(13===t.keyCode){t.preventDefault();var o=e.$left.find(\"option:selected:not(.hidden)\");o.length&&e.moveToRight(o,t)}}),e.$right.on(\"dblclick\",\"option\",function(t){t.preventDefault();var o=e.$right.find(\"option:selected:not(.hidden)\");o.length&&e.moveToLeft(o,t)}),e.$right.on(\"click\",\"optgroup\",function(e){\"OPTGROUP\"==t(e.target).prop(\"tagName\")&&t(this).children().prop(\"selected\",!0)}),e.$right.on(\"keydown\",function(t){if(8===t.keyCode||46===t.keyCode){t.preventDefault();var o=e.$right.find(\"option:selected:not(.hidden)\");o.length&&e.moveToLeft(o,t)}}),(navigator.userAgent.match(/MSIE/i)||navigator.userAgent.indexOf(\"Trident/\")>0||navigator.userAgent.indexOf(\"Edge/\")>0)&&(e.$left.dblclick(function(t){e.actions.$rightSelected.trigger(\"click\")}),e.$right.dblclick(function(t){e.actions.$leftSelected.trigger(\"click\")})),e.actions.$rightSelected.on(\"click\",function(o){o.preventDefault();var n=e.$left.find(\"option:selected:not(.hidden)\");n.length&&e.moveToRight(n,o),t(this).blur()}),e.actions.$leftSelected.on(\"click\",function(o){o.preventDefault();var n=e.$right.find(\"option:selected:not(.hidden)\");n.length&&e.moveToLeft(n,o),t(this).blur()}),e.actions.$rightAll.on(\"click\",function(o){o.preventDefault();var n=e.$left.children(\":not(span):not(.hidden)\");n.length&&e.moveToRight(n,o),t(this).blur()}),e.actions.$leftAll.on(\"click\",function(o){o.preventDefault();var n=e.$right.children(\":not(span):not(.hidden)\");n.length&&e.moveToLeft(n,o),t(this).blur()}),e.actions.$undo.on(\"click\",function(t){t.preventDefault(),e.undo(t)}),e.actions.$redo.on(\"click\",function(t){t.preventDefault(),e.redo(t)}),e.actions.$moveUp.on(\"click\",function(o){o.preventDefault();var n=e.$right.find(\":selected:not(span):not(.hidden)\");n.length&&e.moveUp(n,o),t(this).blur()}),e.actions.$moveDown.on(\"click\",function(o){o.preventDefault();var n=e.$right.find(\":selected:not(span):not(.hidden)\");n.length&&e.moveDown(n,o),t(this).blur()})},moveToRight:function(t,e,o,n){var i=this;return\"function\"==typeof i.callbacks.moveToRight?i.callbacks.moveToRight(i,t,e,o,n):!(\"function\"==typeof i.callbacks.beforeMoveToRight&&!o&&!i.callbacks.beforeMoveToRight(i.$left,i.$right,t))&&(i.moveFromAtoB(i.$left,i.$right,t,e,o,n),n||(i.undoStack.push([\"right\",t]),i.redoStack=[]),\"function\"!=typeof i.callbacks.sort.right||o||i.doNotSortRight||i.$right.mSort(i.callbacks.sort.right),\"function\"!=typeof i.callbacks.afterMoveToRight||o||i.callbacks.afterMoveToRight(i.$left,i.$right,t),i)},moveToLeft:function(t,e,o,n){var i=this;return\"function\"==typeof i.callbacks.moveToLeft?i.callbacks.moveToLeft(i,t,e,o,n):!(\"function\"==typeof i.callbacks.beforeMoveToLeft&&!o&&!i.callbacks.beforeMoveToLeft(i.$left,i.$right,t))&&(i.moveFromAtoB(i.$right,i.$left,t,e,o,n),n||(i.undoStack.push([\"left\",t]),i.redoStack=[]),\"function\"!=typeof i.callbacks.sort.left||o||i.$left.mSort(i.callbacks.sort.left),\"function\"!=typeof i.callbacks.afterMoveToLeft||o||i.callbacks.afterMoveToLeft(i.$left,i.$right,t),i)},moveFromAtoB:function(e,o,n,i,r,l){var c=this;return\"function\"==typeof c.callbacks.moveFromAtoB?c.callbacks.moveFromAtoB(c,e,o,n,i,r,l):(n.each(function(e,n){var i=t(n);if(c.options.ignoreDisabled&&i.is(\":disabled\"))return!0;if(i.is(\"optgroup\")||i.parent().is(\"optgroup\")){var r=i.is(\"optgroup\")?i:i.parent(),l=\"optgroup[\"+c.options.matchOptgroupBy+'=\"'+r.prop(c.options.matchOptgroupBy)+'\"]',a=o.find(l);if(a.length||(a=r.clone(!0),a.empty(),o.move(a)),i.is(\"optgroup\")){var f=\"\";c.options.ignoreDisabled&&(f=\":not(:disabled)\"),a.move(i.find(\"option\"+f))}else a.move(i);r.removeIfEmpty()}else o.move(i)}),c)},moveUp:function(t){var e=this;if(\"function\"==typeof e.callbacks.beforeMoveUp&&!e.callbacks.beforeMoveUp(t))return!1;t.first().prev().before(t),\"function\"==typeof e.callbacks.afterMoveUp&&e.callbacks.afterMoveUp(t)},moveDown:function(t){var e=this;if(\"function\"==typeof e.callbacks.beforeMoveDown&&!e.callbacks.beforeMoveDown(t))return!1;t.last().next().after(t),\"function\"==typeof e.callbacks.afterMoveDown&&e.callbacks.afterMoveDown(t)},undo:function(t){var e=this,o=e.undoStack.pop();if(o)switch(e.redoStack.push(o),o[0]){case\"left\":e.moveToRight(o[1],t,!1,!0);break;case\"right\":e.moveToLeft(o[1],t,!1,!0)}},redo:function(t){var e=this,o=e.redoStack.pop();if(o)switch(e.undoStack.push(o),o[0]){case\"left\":e.moveToLeft(o[1],t,!1,!0);break;case\"right\":e.moveToRight(o[1],t,!1,!0)}}},e}(t);t.multiselect={defaults:{startUp:function(e,o){o.find(\"option\").each(function(o,n){if(\"OPTGROUP\"==t(n).parent().prop(\"tagName\")){var i='optgroup[label=\"'+t(n).parent().attr(\"label\")+'\"]';e.find(i+' option[value=\"'+n.value+'\"]').each(function(t,e){e.remove()}),e.find(i).removeIfEmpty()}else{e.find('option[value=\"'+n.value+'\"]').remove()}})},afterInit:function(){return!0},beforeMoveToRight:function(t,e,o){return!0},afterMoveToRight:function(t,e,o){},beforeMoveToLeft:function(t,e,o){return!0},afterMoveToLeft:function(t,e,o){},beforeMoveUp:function(t){return!0},afterMoveUp:function(t){},beforeMoveDown:function(t){return!0},afterMoveDown:function(t){},sort:function(t,e){return\"NA\"==t.innerHTML?1:\"NA\"==e.innerHTML?-1:t.innerHTML>e.innerHTML?1:-1},fireSearch:function(t){return t.length>1}}};var o=window.navigator.userAgent,n=o.indexOf(\"MSIE \")+o.indexOf(\"Trident/\")+o.indexOf(\"Edge/\")>-3,i=o.toLowerCase().indexOf(\"safari\")>-1,r=o.toLowerCase().indexOf(\"firefox\")>-1;t.fn.multiselect=function(o){return this.each(function(){var n=t(this),i=n.data(\"crlcu.multiselect\"),r=t.extend({},t.multiselect.defaults,n.data(),\"object\"==typeof o&&o);i||n.data(\"crlcu.multiselect\",i=new e(n,r))})},t.fn.move=function(t){return this.append(t).find(\"option\").prop(\"selected\",!1),this},t.fn.removeIfEmpty=function(){return this.children().length||this.remove(),this},t.fn.mShow=function(){return this.removeClass(\"hidden\").show(),(n||i)&&this.each(function(e,o){t(o).parent().is(\"span\")&&t(o).parent().replaceWith(o),t(o).show()}),r&&this.attr(\"disabled\",!1),this},t.fn.mHide=function(){return this.addClass(\"hidden\").hide(),(n||i)&&this.each(function(e,o){t(o).parent().is(\"span\")||t(o).wrap(\"<span>\").hide()}),r&&this.attr(\"disabled\",!0),this},t.fn.mSort=function(e){return this.children().sort(e).appendTo(this),this.find(\"optgroup\").each(function(o,n){t(n).children().sort(e).appendTo(n)}),this},t.fn.attachIndex=function(){this.children().each(function(e,o){var n=t(o);n.is(\"optgroup\")&&n.children().each(function(e,o){t(o).data(\"position\",e)}),n.data(\"position\",e)})},t.expr[\":\"].search=function(e,o,n){var i=new RegExp(n[3].replace(/([^a-zA-Z0-9])/g,\"\\\\$1\"),\"i\");return t(e).text().match(i)}});\n</script>\n<nav>\n    <div class=\"nav nav-tabs\" id=\"nav-tab\" role=\"tablist\">\n        <a class=\"nav-item nav-link active\" id=\"nav-home-tab\" data-toggle=\"tab\" href=\"#nav-columns\" role=\"tab\"\n            aria-controls=\"nav-home\" aria-selected=\"true\">Columns</a>\n        <a class=\"nav-item nav-link\" id=\"nav-profile-tab\" data-toggle=\"tab\" href=\"#nav-grouping\" role=\"tab\"\n            aria-controls=\"nav-profile\" aria-selected=\"false\">Grouping</a>\n    </div>\n</nav>\n<div class=\"tab-content\" id=\"nav-tabContent\">\n    <div class=\"tab-pane fade show active\" id=\"nav-columns\" role=\"tabpanel\" aria-labelledby=\"nav-home-tab\">\n        <div class=\"row\">\n            <div class=\"col-sm-5\">\n                <select name=\"from[]\" id=\"available_columns\" class=\"form-control\" size=\"8\" multiple=\"multiple\">\n                </select>\n            </div>\n\n            <div class=\"col-sm-2\">\n                <button type=\"button\" id=\"available_columns_rightAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-forward\"></i></button>\n                <button type=\"button\" id=\"available_columns_rightSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-right\"></i></button>\n                <button type=\"button\" id=\"available_columns_leftSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-left\"></i></button>\n                <button type=\"button\" id=\"available_columns_leftAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-backward\"></i></button>\n            </div>\n\n            <div class=\"col-sm-5\">\n                <select name=\"to[]\" id=\"available_columns_to\" class=\"form-control\" size=\"8\"\n                    multiple=\"multiple\"></select>\n\n                <div class=\"row\">\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_columns_move_up\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-up\"></i></button>\n                    </div>\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_columns_move_down\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-down\"></i></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane fade\" id=\"nav-grouping\" role=\"tabpanel\" aria-labelledby=\"nav-profile-tab\">\n        <div class=\"row\">\n            <div class=\"col-sm-5\">\n                <select name=\"from[]\" id=\"available_grouping\" class=\"form-control\" size=\"8\" multiple=\"multiple\">\n                </select>\n            </div>\n\n            <div class=\"col-sm-2\">\n                <button type=\"button\" id=\"available_grouping_rightAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-forward\"></i></button>\n                <button type=\"button\" id=\"available_grouping_rightSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-right\"></i></button>\n                <button type=\"button\" id=\"available_grouping_leftSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-left\"></i></button>\n                <button type=\"button\" id=\"available_grouping_leftAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-backward\"></i></button>\n            </div>\n\n            <div class=\"col-sm-5\">\n                <select name=\"to[]\" id=\"available_grouping_to\" class=\"form-control\" size=\"8\"\n                    multiple=\"multiple\"></select>\n\n                <div class=\"row\">\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_grouping_move_up\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-up\"></i></button>\n                    </div>\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_grouping_move_down\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-down\"></i></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>","jsText":"this.initialize = function() {\n\n    this.listBoxAC = $(\"#available_columns\");\n    this.listBoxSC = $(\"#available_columns_to\");\n    this.listBoxAC.multiselect({\n        afterMoveToRight: this.onSelectedColumnsChange.bind(this),\n        afterMoveToLeft: this.onSelectedColumnsChange.bind(this),\n        afterMoveUp: this.onSelectedColumnsChange.bind(this),\n        afterMoveDown: this.onSelectedColumnsChange.bind(this)\n    }); \n\n    this.listBoxAG = $(\"#available_grouping\");\n    this.listBoxSG = $(\"#available_grouping_to\");\n    this.listBoxAG.multiselect({\n        afterMoveToRight: this.onSelectedGroupsChange.bind(this),\n        afterMoveToLeft: this.onSelectedGroupsChange.bind(this),\n        afterMoveUp: this.onSelectedGroupsChange.bind(this),\n        afterMoveDown: this.onSelectedGroupsChange.bind(this)\n    });\n\n    this.prevAvailable = null;\n    this.prevConfig = {};\n    this.baseQuery = \"\";\n};\n\nthis.updateQuery = function() {\n    let selected = this.prevConfig.selected || [];\n    let selectedGroups = this.prevConfig.selectedGroups || [];\n    \n    let columns = selected.map(name => this.prevAvailable.find(e => e.name === name));\n    let groups = selectedGroups.map(name => this.prevAvailable.find(e => e.name === name));\n    let columnText = columns.map(e => `${e.expr} as [${e.name}]`).join(\", \");\n    let formats = columns.filter(e => e.format).reduce((o, e) => (o[e.name] = e.format, o), {});\n    let groupText = groups.length > 0 ? (\"GROUP BY \" + groups.map(e => e.expr).join(\", \") + \" WITH ROLLUP\") : \"\";\n    let query = this.baseQuery.replace(\"%%COLUMNS%%\", columnText).replace(\"%%GROUPS%%\", groupText);\n    let formatText = JSON.stringify(formats);\n    this.context.set(\"Query\", query);\n    this.context.set(\"Formatting\", formatText);\n};\n\nthis.onSelectedColumnsChange = function(e) {\n    this.prevConfig.selected = Array.from(this.listBoxSC.children('option')).map(e => $(e).text());\n        this.context.set(\"Config\", JSON.stringify(this.prevConfig));\n    this.updateQuery();\n};\nthis.onSelectedGroupsChange = function(e) {\n    this.prevConfig.selectedGroups =  Array.from(this.listBoxSG.children('option')).map(e => $(e).text());\n        this.context.set(\"Config\", JSON.stringify(this.prevConfig));\n    this.updateQuery();\n};\n\nthis.render = function(args) {\n    let available = args[0];\n    let config = typeof args[1] === \"string\" ?JSON.parse(args[1]) : {};\n    let doRefresh = false;\n    available.sort(function (a, b) {\n        return a.name.localeCompare(b.name);\n    });\n    \n    //Remove selected columns which are no longer available\n    let selected = config.selected || [];\n    let selectedGroups = config.selectedGroups || [];\n    selected = selected.filter(name => available.find(a => a.name === name) != null);\n    selectedGroups = selectedGroups.filter(name => available.find(a => a.name === name) != null);\n\n    this.baseQuery = args[4];\n\n    if (!_.isEqual(this.prevAvailable, available) || !_.isEqual(this.prevConfig, config)) {\n        this.listBoxAC.empty();\n        this.listBoxAG.empty();\n        for(let e of available) {\n            //Exclude selected columns from the available columns for now\n            if (selected.indexOf(e.name) === -1)\n                this.listBoxAC.append($(\"<option>\").text(e.name));\n            if (e.canGroup && selectedGroups.indexOf(e.name) === -1)\n                this.listBoxAG.append($(\"<option>\").text(e.name));\n        }\n        this.prevAvailable = available;\n\n        this.listBoxSC.empty();\n        for (let e of selected) {\n            this.listBoxSC.append($(\"<option>\").text(e));\n        }\n        this.listBoxSG.empty();\n        for (let e of selectedGroups) {\n            this.listBoxSG.append($(\"<option>\").text(e));\n        }\n        \n        this.prevConfig = config;\n        this.context.set(\"Config\", JSON.stringify(this.prevConfig));\n        this.updateQuery();\n    }\n};\n","cssText":""},"functionType":"UserDefinedEvalPart","arguments":[{"name":"AvailableColumns","typeAnnotation":"Object","defaultValue":{"typeName":"Object","value":[{"name":"x","expr":"x","canGroup":true},{"name":"x2","expr":"x*2"},{"name":"x3","expr":"x*3"}]},"metadata":null},{"name":"Config","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"Query","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"Formatting","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"BaseQuery","typeAnnotation":"String","defaultValue":{"typeName":"String","value":"SELECT\n  %%COLUMNS%%\nFROM\n  Lattice('x = 1 to 10 step 1')"},"metadata":null}],"returnType":"Any"},"df5cd053-255a-4ed7-b2f4-d66c65e4cd1f":{"typeName":"Part","id":"df5cd053-255a-4ed7-b2f4-d66c65e4cd1f","name":"ViewSelector","path":"/ViewSelector","lastModified":"2019-08-29T21:20:03.220Z","data":{"htmlText":"<link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.5.0/css/all.css\"\n      integrity=\"sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU\"\n      crossorigin=\"anonymous\">\n<span class=\"view\">\n    <input type=\"text\" id=\"viewName\" value=\"test\"/>\n    <button id=\"addView\" title=\"Add View\"><i class=\"fas fa-plus\"></i></button>\n    <button id=\"deleteView\" title=\"Remove View\"><i class=\"fas fa-trash\"></i></button>\n</span>","jsText":"let addView;\nlet deleteView;\nlet viewName;\nlet viewNames = new Set();\nlet storedViews = {};\n\nthis.initialize = function() {\n    addView = document.getElementById(\"addView\");\n    deleteView = document.getElementById(\"deleteView\");\n    viewName = document.getElementById(\"viewName\");\n    \n    addView.addEventListener(\"click\", (ev) => {\n        viewNames.add(viewName.value);\n        storedViews[viewName.value] = this.context.get(\"Config\");\n        this.context.set(\"ViewNames\", [...viewNames]);\n        this.setSelectedView(viewName.value);\n    });\n    deleteView.addEventListener(\"click\", (ev) => {\n        delete storedViews[viewName.value];\n        viewNames.delete(viewName.value);\n        this.context.set(\"ViewNames\", [...viewNames]);\n        this.setSelectedView([...viewNames][0]);\n    });\n};\n\nthis.setSelectedView = function(selectedView) {\n    viewName.value = selectedView;\n    this.context.set(\"SelectedView\", selectedView);\n    this.context.set(\"Config\", storedViews[selectedView]);\n};\nlet hasRun = false;\nthis.render = function(args) {\n    if (hasRun && args[2] !== viewName.value) {\n        this.setSelectedView(args[2]);\n    } else if (!hasRun) {\n        viewNames = new Set(args[0]);\n        if (args[3] != null) {\n            storedViews = args[3];\n        }\n        viewName.value = args[2];\n        hasRun = true;\n    }\n    this.context.set(\"__storedViews\", storedViews);\n};\n","cssText":".foo {\n  color: white;\n  background-color: purple;\n}\n"},"functionType":"UserDefinedEvalPart","arguments":[{"name":"ViewNames","typeAnnotation":"Array","defaultValue":null,"metadata":null},{"name":"Config","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"SelectedView","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"__storedViews","typeAnnotation":"Object","defaultValue":null,"metadata":null}],"returnType":"Any"},"ViewEditor":{"typeName":"Part","id":"17608d72-9b36-4452-bf8b-4a4721cf5bd2","name":"ViewEditor","path":"/ViewEditor","lastModified":"2019-08-29T21:20:03.220Z","data":{"htmlText":"<link rel=\"stylesheet\" href=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css\" integrity=\"sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm\" crossorigin=\"anonymous\">\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css\">\n<script src=\"https://code.jquery.com/jquery-3.2.1.slim.min.js\" integrity=\"sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js\" integrity=\"sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q\" crossorigin=\"anonymous\"></script>\n<script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js\" integrity=\"sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.15/lodash.min.js\"></script>\n<script>/*\n * @license\n *\n * Multiselect v2.5.5\n * http://crlcu.github.io/multiselect/\n *\n * Copyright (c) 2016-2018 Adrian Crisan\n * Licensed under the MIT license (https://github.com/crlcu/multiselect/blob/master/LICENSE)\n */\n\nif(\"undefined\"==typeof jQuery)throw new Error(\"multiselect requires jQuery\");!function(t){\"use strict\";var e=t.fn.jquery.split(\" \")[0].split(\".\");if(e[0]<2&&e[1]<7)throw new Error(\"multiselect requires jQuery version 1.7 or higher\")}(jQuery),function(t){\"function\"==typeof define&&define.amd?define([\"jquery\"],t):t(jQuery)}(function(t){\"use strict\";var e=function(t){function e(e,o){var n=e.prop(\"id\");if(this.$left=e,this.$right=t(t(o.right).length?o.right:\"#\"+n+\"_to\"),this.actions={$leftAll:t(t(o.leftAll).length?o.leftAll:\"#\"+n+\"_leftAll\"),$rightAll:t(t(o.rightAll).length?o.rightAll:\"#\"+n+\"_rightAll\"),$leftSelected:t(t(o.leftSelected).length?o.leftSelected:\"#\"+n+\"_leftSelected\"),$rightSelected:t(t(o.rightSelected).length?o.rightSelected:\"#\"+n+\"_rightSelected\"),$undo:t(t(o.undo).length?o.undo:\"#\"+n+\"_undo\"),$redo:t(t(o.redo).length?o.redo:\"#\"+n+\"_redo\"),$moveUp:t(t(o.moveUp).length?o.moveUp:\"#\"+n+\"_move_up\"),$moveDown:t(t(o.moveDown).length?o.moveDown:\"#\"+n+\"_move_down\")},delete o.leftAll,delete o.leftSelected,delete o.right,delete o.rightAll,delete o.rightSelected,delete o.undo,delete o.redo,delete o.moveUp,delete o.moveDown,this.options={keepRenderingSort:o.keepRenderingSort,submitAllLeft:void 0===o.submitAllLeft||o.submitAllLeft,submitAllRight:void 0===o.submitAllRight||o.submitAllRight,search:o.search,ignoreDisabled:void 0!==o.ignoreDisabled&&o.ignoreDisabled,matchOptgroupBy:void 0!==o.matchOptgroupBy?o.matchOptgroupBy:\"label\"},delete o.keepRenderingSort,o.submitAllLeft,o.submitAllRight,o.search,o.ignoreDisabled,o.matchOptgroupBy,this.callbacks=o,\"function\"==typeof this.callbacks.sort){var i=this.callbacks.sort;this.callbacks.sort={left:i,right:i}}this.init()}return e.prototype={init:function(){var e=this;e.undoStack=[],e.redoStack=[],e.options.keepRenderingSort&&(e.skipInitSort=!0,!1!==e.callbacks.sort&&(e.callbacks.sort={left:function(e,o){return t(e).data(\"position\")>t(o).data(\"position\")?1:-1},right:function(e,o){return t(e).data(\"position\")>t(o).data(\"position\")?1:-1}}),e.$left.attachIndex(),e.$right.each(function(e,o){t(o).attachIndex()})),\"function\"==typeof e.callbacks.startUp&&e.callbacks.startUp(e.$left,e.$right),e.skipInitSort||(\"function\"==typeof e.callbacks.sort.left&&e.$left.mSort(e.callbacks.sort.left),\"function\"==typeof e.callbacks.sort.right&&e.$right.each(function(o,n){t(n).mSort(e.callbacks.sort.right)})),e.options.search&&e.options.search.left&&(e.options.search.$left=t(e.options.search.left),e.$left.before(e.options.search.$left)),e.options.search&&e.options.search.right&&(e.options.search.$right=t(e.options.search.right),e.$right.before(t(e.options.search.$right))),e.events(),\"function\"==typeof e.callbacks.afterInit&&e.callbacks.afterInit()},events:function(){var e=this;e.options.search&&e.options.search.$left&&e.options.search.$left.on(\"keyup\",function(t){if(e.callbacks.fireSearch(this.value)){e.$left.find('option:search(\"'+this.value+'\")').mShow(),e.$left.find('option:not(:search(\"'+this.value+'\"))').mHide(),e.$left.find(\"option\").closest(\"optgroup\").mHide(),e.$left.find(\"option:not(.hidden)\").parent(\"optgroup\").mShow()}else e.$left.find(\"option, optgroup\").mShow()}),e.options.search&&e.options.search.$right&&e.options.search.$right.on(\"keyup\",function(t){if(e.callbacks.fireSearch(this.value)){e.$right.find('option:search(\"'+this.value+'\")').mShow(),e.$right.find('option:not(:search(\"'+this.value+'\"))').mHide(),e.$right.find(\"option\").closest(\"optgroup\").mHide(),e.$right.find(\"option:not(.hidden)\").parent(\"optgroup\").mShow()}else e.$right.find(\"option, optgroup\").mShow()}),e.$right.closest(\"form\").on(\"submit\",function(t){e.options.search&&(e.options.search.$left&&e.options.search.$left.val(\"\").trigger(\"keyup\"),e.options.search.$right&&e.options.search.$right.val(\"\").trigger(\"keyup\")),e.$left.find(\"option\").prop(\"selected\",e.options.submitAllLeft),e.$right.find(\"option\").prop(\"selected\",e.options.submitAllRight)}),e.$left.on(\"dblclick\",\"option\",function(t){t.preventDefault();var o=e.$left.find(\"option:selected:not(.hidden)\");o.length&&e.moveToRight(o,t)}),e.$left.on(\"click\",\"optgroup\",function(e){\"OPTGROUP\"==t(e.target).prop(\"tagName\")&&t(this).children().prop(\"selected\",!0)}),e.$left.on(\"keypress\",function(t){if(13===t.keyCode){t.preventDefault();var o=e.$left.find(\"option:selected:not(.hidden)\");o.length&&e.moveToRight(o,t)}}),e.$right.on(\"dblclick\",\"option\",function(t){t.preventDefault();var o=e.$right.find(\"option:selected:not(.hidden)\");o.length&&e.moveToLeft(o,t)}),e.$right.on(\"click\",\"optgroup\",function(e){\"OPTGROUP\"==t(e.target).prop(\"tagName\")&&t(this).children().prop(\"selected\",!0)}),e.$right.on(\"keydown\",function(t){if(8===t.keyCode||46===t.keyCode){t.preventDefault();var o=e.$right.find(\"option:selected:not(.hidden)\");o.length&&e.moveToLeft(o,t)}}),(navigator.userAgent.match(/MSIE/i)||navigator.userAgent.indexOf(\"Trident/\")>0||navigator.userAgent.indexOf(\"Edge/\")>0)&&(e.$left.dblclick(function(t){e.actions.$rightSelected.trigger(\"click\")}),e.$right.dblclick(function(t){e.actions.$leftSelected.trigger(\"click\")})),e.actions.$rightSelected.on(\"click\",function(o){o.preventDefault();var n=e.$left.find(\"option:selected:not(.hidden)\");n.length&&e.moveToRight(n,o),t(this).blur()}),e.actions.$leftSelected.on(\"click\",function(o){o.preventDefault();var n=e.$right.find(\"option:selected:not(.hidden)\");n.length&&e.moveToLeft(n,o),t(this).blur()}),e.actions.$rightAll.on(\"click\",function(o){o.preventDefault();var n=e.$left.children(\":not(span):not(.hidden)\");n.length&&e.moveToRight(n,o),t(this).blur()}),e.actions.$leftAll.on(\"click\",function(o){o.preventDefault();var n=e.$right.children(\":not(span):not(.hidden)\");n.length&&e.moveToLeft(n,o),t(this).blur()}),e.actions.$undo.on(\"click\",function(t){t.preventDefault(),e.undo(t)}),e.actions.$redo.on(\"click\",function(t){t.preventDefault(),e.redo(t)}),e.actions.$moveUp.on(\"click\",function(o){o.preventDefault();var n=e.$right.find(\":selected:not(span):not(.hidden)\");n.length&&e.moveUp(n,o),t(this).blur()}),e.actions.$moveDown.on(\"click\",function(o){o.preventDefault();var n=e.$right.find(\":selected:not(span):not(.hidden)\");n.length&&e.moveDown(n,o),t(this).blur()})},moveToRight:function(t,e,o,n){var i=this;return\"function\"==typeof i.callbacks.moveToRight?i.callbacks.moveToRight(i,t,e,o,n):!(\"function\"==typeof i.callbacks.beforeMoveToRight&&!o&&!i.callbacks.beforeMoveToRight(i.$left,i.$right,t))&&(i.moveFromAtoB(i.$left,i.$right,t,e,o,n),n||(i.undoStack.push([\"right\",t]),i.redoStack=[]),\"function\"!=typeof i.callbacks.sort.right||o||i.doNotSortRight||i.$right.mSort(i.callbacks.sort.right),\"function\"!=typeof i.callbacks.afterMoveToRight||o||i.callbacks.afterMoveToRight(i.$left,i.$right,t),i)},moveToLeft:function(t,e,o,n){var i=this;return\"function\"==typeof i.callbacks.moveToLeft?i.callbacks.moveToLeft(i,t,e,o,n):!(\"function\"==typeof i.callbacks.beforeMoveToLeft&&!o&&!i.callbacks.beforeMoveToLeft(i.$left,i.$right,t))&&(i.moveFromAtoB(i.$right,i.$left,t,e,o,n),n||(i.undoStack.push([\"left\",t]),i.redoStack=[]),\"function\"!=typeof i.callbacks.sort.left||o||i.$left.mSort(i.callbacks.sort.left),\"function\"!=typeof i.callbacks.afterMoveToLeft||o||i.callbacks.afterMoveToLeft(i.$left,i.$right,t),i)},moveFromAtoB:function(e,o,n,i,r,l){var c=this;return\"function\"==typeof c.callbacks.moveFromAtoB?c.callbacks.moveFromAtoB(c,e,o,n,i,r,l):(n.each(function(e,n){var i=t(n);if(c.options.ignoreDisabled&&i.is(\":disabled\"))return!0;if(i.is(\"optgroup\")||i.parent().is(\"optgroup\")){var r=i.is(\"optgroup\")?i:i.parent(),l=\"optgroup[\"+c.options.matchOptgroupBy+'=\"'+r.prop(c.options.matchOptgroupBy)+'\"]',a=o.find(l);if(a.length||(a=r.clone(!0),a.empty(),o.move(a)),i.is(\"optgroup\")){var f=\"\";c.options.ignoreDisabled&&(f=\":not(:disabled)\"),a.move(i.find(\"option\"+f))}else a.move(i);r.removeIfEmpty()}else o.move(i)}),c)},moveUp:function(t){var e=this;if(\"function\"==typeof e.callbacks.beforeMoveUp&&!e.callbacks.beforeMoveUp(t))return!1;t.first().prev().before(t),\"function\"==typeof e.callbacks.afterMoveUp&&e.callbacks.afterMoveUp(t)},moveDown:function(t){var e=this;if(\"function\"==typeof e.callbacks.beforeMoveDown&&!e.callbacks.beforeMoveDown(t))return!1;t.last().next().after(t),\"function\"==typeof e.callbacks.afterMoveDown&&e.callbacks.afterMoveDown(t)},undo:function(t){var e=this,o=e.undoStack.pop();if(o)switch(e.redoStack.push(o),o[0]){case\"left\":e.moveToRight(o[1],t,!1,!0);break;case\"right\":e.moveToLeft(o[1],t,!1,!0)}},redo:function(t){var e=this,o=e.redoStack.pop();if(o)switch(e.undoStack.push(o),o[0]){case\"left\":e.moveToLeft(o[1],t,!1,!0);break;case\"right\":e.moveToRight(o[1],t,!1,!0)}}},e}(t);t.multiselect={defaults:{startUp:function(e,o){o.find(\"option\").each(function(o,n){if(\"OPTGROUP\"==t(n).parent().prop(\"tagName\")){var i='optgroup[label=\"'+t(n).parent().attr(\"label\")+'\"]';e.find(i+' option[value=\"'+n.value+'\"]').each(function(t,e){e.remove()}),e.find(i).removeIfEmpty()}else{e.find('option[value=\"'+n.value+'\"]').remove()}})},afterInit:function(){return!0},beforeMoveToRight:function(t,e,o){return!0},afterMoveToRight:function(t,e,o){},beforeMoveToLeft:function(t,e,o){return!0},afterMoveToLeft:function(t,e,o){},beforeMoveUp:function(t){return!0},afterMoveUp:function(t){},beforeMoveDown:function(t){return!0},afterMoveDown:function(t){},sort:function(t,e){return\"NA\"==t.innerHTML?1:\"NA\"==e.innerHTML?-1:t.innerHTML>e.innerHTML?1:-1},fireSearch:function(t){return t.length>1}}};var o=window.navigator.userAgent,n=o.indexOf(\"MSIE \")+o.indexOf(\"Trident/\")+o.indexOf(\"Edge/\")>-3,i=o.toLowerCase().indexOf(\"safari\")>-1,r=o.toLowerCase().indexOf(\"firefox\")>-1;t.fn.multiselect=function(o){return this.each(function(){var n=t(this),i=n.data(\"crlcu.multiselect\"),r=t.extend({},t.multiselect.defaults,n.data(),\"object\"==typeof o&&o);i||n.data(\"crlcu.multiselect\",i=new e(n,r))})},t.fn.move=function(t){return this.append(t).find(\"option\").prop(\"selected\",!1),this},t.fn.removeIfEmpty=function(){return this.children().length||this.remove(),this},t.fn.mShow=function(){return this.removeClass(\"hidden\").show(),(n||i)&&this.each(function(e,o){t(o).parent().is(\"span\")&&t(o).parent().replaceWith(o),t(o).show()}),r&&this.attr(\"disabled\",!1),this},t.fn.mHide=function(){return this.addClass(\"hidden\").hide(),(n||i)&&this.each(function(e,o){t(o).parent().is(\"span\")||t(o).wrap(\"<span>\").hide()}),r&&this.attr(\"disabled\",!0),this},t.fn.mSort=function(e){return this.children().sort(e).appendTo(this),this.find(\"optgroup\").each(function(o,n){t(n).children().sort(e).appendTo(n)}),this},t.fn.attachIndex=function(){this.children().each(function(e,o){var n=t(o);n.is(\"optgroup\")&&n.children().each(function(e,o){t(o).data(\"position\",e)}),n.data(\"position\",e)})},t.expr[\":\"].search=function(e,o,n){var i=new RegExp(n[3].replace(/([^a-zA-Z0-9])/g,\"\\\\$1\"),\"i\");return t(e).text().match(i)}});\n</script>\n<nav>\n    <div class=\"nav nav-tabs\" id=\"nav-tab\" role=\"tablist\">\n        <a class=\"nav-item nav-link active\" id=\"nav-home-tab\" data-toggle=\"tab\" href=\"#nav-columns\" role=\"tab\"\n            aria-controls=\"nav-home\" aria-selected=\"true\">Columns</a>\n        <a class=\"nav-item nav-link\" id=\"nav-profile-tab\" data-toggle=\"tab\" href=\"#nav-grouping\" role=\"tab\"\n            aria-controls=\"nav-profile\" aria-selected=\"false\">Grouping</a>\n    </div>\n</nav>\n<div class=\"tab-content\" id=\"nav-tabContent\">\n    <div class=\"tab-pane fade show active\" id=\"nav-columns\" role=\"tabpanel\" aria-labelledby=\"nav-home-tab\">\n        <div class=\"row\">\n            <div class=\"col-sm-5\">\n                <select name=\"from[]\" id=\"available_columns\" class=\"form-control\" size=\"8\" multiple=\"multiple\">\n                </select>\n            </div>\n\n            <div class=\"col-sm-2\">\n                <button type=\"button\" id=\"available_columns_rightAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-forward\"></i></button>\n                <button type=\"button\" id=\"available_columns_rightSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-right\"></i></button>\n                <button type=\"button\" id=\"available_columns_leftSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-left\"></i></button>\n                <button type=\"button\" id=\"available_columns_leftAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-backward\"></i></button>\n            </div>\n\n            <div class=\"col-sm-5\">\n                <select name=\"to[]\" id=\"available_columns_to\" class=\"form-control\" size=\"8\"\n                    multiple=\"multiple\"></select>\n\n                <div class=\"row\">\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_columns_move_up\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-up\"></i></button>\n                    </div>\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_columns_move_down\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-down\"></i></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"tab-pane fade\" id=\"nav-grouping\" role=\"tabpanel\" aria-labelledby=\"nav-profile-tab\">\n        <div class=\"row\">\n            <div class=\"col-sm-5\">\n                <select name=\"from[]\" id=\"available_grouping\" class=\"form-control\" size=\"8\" multiple=\"multiple\">\n                </select>\n            </div>\n\n            <div class=\"col-sm-2\">\n                <button type=\"button\" id=\"available_grouping_rightAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-forward\"></i></button>\n                <button type=\"button\" id=\"available_grouping_rightSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-right\"></i></button>\n                <button type=\"button\" id=\"available_grouping_leftSelected\" class=\"btn btn-block\"><i\n                        class=\"fa fa-chevron-left\"></i></button>\n                <button type=\"button\" id=\"available_grouping_leftAll\" class=\"btn btn-block\"><i\n                        class=\"fa fa-backward\"></i></button>\n            </div>\n\n            <div class=\"col-sm-5\">\n                <select name=\"to[]\" id=\"available_grouping_to\" class=\"form-control\" size=\"8\"\n                    multiple=\"multiple\"></select>\n\n                <div class=\"row\">\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_grouping_move_up\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-up\"></i></button>\n                    </div>\n                    <div class=\"col-sm-6\">\n                        <button type=\"button\" id=\"available_grouping_move_down\" class=\"btn btn-block\"><i\n                                class=\"fa fa-arrow-down\"></i></button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>","jsText":"this.initialize = function() {\n\n    this.listBoxAC = $(\"#available_columns\");\n    this.listBoxSC = $(\"#available_columns_to\");\n    this.listBoxAC.multiselect({\n        afterMoveToRight: this.onSelectedColumnsChange.bind(this),\n        afterMoveToLeft: this.onSelectedColumnsChange.bind(this),\n        afterMoveUp: this.onSelectedColumnsChange.bind(this),\n        afterMoveDown: this.onSelectedColumnsChange.bind(this)\n    }); \n\n    this.listBoxAG = $(\"#available_grouping\");\n    this.listBoxSG = $(\"#available_grouping_to\");\n    this.listBoxAG.multiselect({\n        afterMoveToRight: this.onSelectedGroupsChange.bind(this),\n        afterMoveToLeft: this.onSelectedGroupsChange.bind(this),\n        afterMoveUp: this.onSelectedGroupsChange.bind(this),\n        afterMoveDown: this.onSelectedGroupsChange.bind(this)\n    });\n\n    this.prevAvailable = null;\n    this.prevConfig = {};\n    this.baseQuery = \"\";\n};\n\nthis.updateQuery = function() {\n    let selected = this.prevConfig.selected || [];\n    let selectedGroups = this.prevConfig.selectedGroups || [];\n    \n    let columns = selected.map(name => this.prevAvailable.find(e => e.name === name));\n    let groups = selectedGroups.map(name => this.prevAvailable.find(e => e.name === name));\n    let columnText = columns.map(e => `${e.expr} as [${e.name}]`).join(\", \");\n    let formats = columns.filter(e => e.format).reduce((o, e) => (o[e.name] = e.format, o), {});\n    let groupText = groups.length > 0 ? (\"GROUP BY \" + groups.map(e => e.expr).join(\", \") + \" WITH ROLLUP\") : \"\";\n    let query = this.baseQuery.replace(\"%%COLUMNS%%\", columnText).replace(\"%%GROUPS%%\", groupText);\n    let formatText = JSON.stringify(formats);\n    this.context.set(\"Query\", query);\n    this.context.set(\"Formatting\", formatText);\n};\n\nthis.onSelectedColumnsChange = function(e) {\n    this.prevConfig.selected = Array.from(this.listBoxSC.children('option')).map(e => $(e).text());\n        this.context.set(\"Config\", JSON.stringify(this.prevConfig));\n    this.updateQuery();\n};\nthis.onSelectedGroupsChange = function(e) {\n    this.prevConfig.selectedGroups =  Array.from(this.listBoxSG.children('option')).map(e => $(e).text());\n        this.context.set(\"Config\", JSON.stringify(this.prevConfig));\n    this.updateQuery();\n};\n\nthis.render = function(args) {\n    let available = args[0];\n    let config = typeof args[1] === \"string\" ?JSON.parse(args[1]) : {};\n    let doRefresh = false;\n    available.sort(function (a, b) {\n        return a.name.localeCompare(b.name);\n    });\n    \n    //Remove selected columns which are no longer available\n    let selected = config.selected || [];\n    let selectedGroups = config.selectedGroups || [];\n    selected = selected.filter(name => available.find(a => a.name === name) != null);\n    selectedGroups = selectedGroups.filter(name => available.find(a => a.name === name) != null);\n\n    this.baseQuery = args[4];\n\n    if (!_.isEqual(this.prevAvailable, available) || !_.isEqual(this.prevConfig, config)) {\n        this.listBoxAC.empty();\n        this.listBoxAG.empty();\n        for(let e of available) {\n            //Exclude selected columns from the available columns for now\n            if (selected.indexOf(e.name) === -1)\n                this.listBoxAC.append($(\"<option>\").text(e.name));\n            if (e.canGroup && selectedGroups.indexOf(e.name) === -1)\n                this.listBoxAG.append($(\"<option>\").text(e.name));\n        }\n        this.prevAvailable = available;\n\n        this.listBoxSC.empty();\n        for (let e of selected) {\n            this.listBoxSC.append($(\"<option>\").text(e));\n        }\n        this.listBoxSG.empty();\n        for (let e of selectedGroups) {\n            this.listBoxSG.append($(\"<option>\").text(e));\n        }\n        \n        this.prevConfig = config;\n        this.context.set(\"Config\", JSON.stringify(this.prevConfig));\n        this.updateQuery();\n    }\n};\n","cssText":""},"functionType":"UserDefinedEvalPart","arguments":[{"name":"AvailableColumns","typeAnnotation":"Object","defaultValue":{"typeName":"Object","value":[{"name":"x","expr":"x","canGroup":true},{"name":"x2","expr":"x*2"},{"name":"x3","expr":"x*3"}]},"metadata":null},{"name":"Config","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"Query","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"Formatting","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"BaseQuery","typeAnnotation":"String","defaultValue":{"typeName":"String","value":"SELECT\n  %%COLUMNS%%\nFROM\n  Lattice('x = 1 to 10 step 1')"},"metadata":null}],"returnType":"Any"},"ViewSelector":{"typeName":"Part","id":"df5cd053-255a-4ed7-b2f4-d66c65e4cd1f","name":"ViewSelector","path":"/ViewSelector","lastModified":"2019-08-29T21:20:03.220Z","data":{"htmlText":"<link rel=\"stylesheet\" href=\"https://use.fontawesome.com/releases/v5.5.0/css/all.css\"\n      integrity=\"sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU\"\n      crossorigin=\"anonymous\">\n<span class=\"view\">\n    <input type=\"text\" id=\"viewName\" value=\"test\"/>\n    <button id=\"addView\" title=\"Add View\"><i class=\"fas fa-plus\"></i></button>\n    <button id=\"deleteView\" title=\"Remove View\"><i class=\"fas fa-trash\"></i></button>\n</span>","jsText":"let addView;\nlet deleteView;\nlet viewName;\nlet viewNames = new Set();\nlet storedViews = {};\n\nthis.initialize = function() {\n    addView = document.getElementById(\"addView\");\n    deleteView = document.getElementById(\"deleteView\");\n    viewName = document.getElementById(\"viewName\");\n    \n    addView.addEventListener(\"click\", (ev) => {\n        viewNames.add(viewName.value);\n        storedViews[viewName.value] = this.context.get(\"Config\");\n        this.context.set(\"ViewNames\", [...viewNames]);\n        this.setSelectedView(viewName.value);\n    });\n    deleteView.addEventListener(\"click\", (ev) => {\n        delete storedViews[viewName.value];\n        viewNames.delete(viewName.value);\n        this.context.set(\"ViewNames\", [...viewNames]);\n        this.setSelectedView([...viewNames][0]);\n    });\n};\n\nthis.setSelectedView = function(selectedView) {\n    viewName.value = selectedView;\n    this.context.set(\"SelectedView\", selectedView);\n    this.context.set(\"Config\", storedViews[selectedView]);\n};\nlet hasRun = false;\nthis.render = function(args) {\n    if (hasRun && args[2] !== viewName.value) {\n        this.setSelectedView(args[2]);\n    } else if (!hasRun) {\n        viewNames = new Set(args[0]);\n        if (args[3] != null) {\n            storedViews = args[3];\n        }\n        viewName.value = args[2];\n        hasRun = true;\n    }\n    this.context.set(\"__storedViews\", storedViews);\n};\n","cssText":".foo {\n  color: white;\n  background-color: purple;\n}\n"},"functionType":"UserDefinedEvalPart","arguments":[{"name":"ViewNames","typeAnnotation":"Array","defaultValue":null,"metadata":null},{"name":"Config","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"SelectedView","typeAnnotation":"String","defaultValue":null,"metadata":null},{"name":"__storedViews","typeAnnotation":"Object","defaultValue":null,"metadata":null}],"returnType":"Any"}}}